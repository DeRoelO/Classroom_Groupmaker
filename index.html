<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klassenindeling Generator - Optimaliseer Groepsindeling voor het Onderwijs</title>
    <meta name="description" content="Genereer de meest optimale klassenindeling voor basisscholen. Houd rekening met leerlingvoorkeuren en restricties van de juf voor evenwichtige en effectieve groepen.">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            background-color: #f0f2f5;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            max-width: 900px;
            width: 100%;
            background: #ffffff;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-top: 20px;
            margin-bottom: 20px;
        }
        h1, h2, h3 {
            color: #1a202c;
            font-weight: 700;
        }
        h1 { font-size: 2.25rem; margin-bottom: 1.5rem; }
        h2 { font-size: 1.75rem; margin-top: 1.5rem; margin-bottom: 1rem; }
        h3 { font-size: 1.25rem; margin-top: 1rem; margin-bottom: 0.75rem; }
        p { margin-bottom: 1rem; }

        .group-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .group {
            border: 1px solid #e2e8f0;
            padding: 16px;
            border-radius: 8px;
            background-color: #f7fafc;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .group h3 {
            color: #2c5282;
            margin-top: 0;
            margin-bottom: 10px;
        }
        .group ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .group li {
            padding: 4px 0;
            border-bottom: 1px dashed #ebf4ff;
        }
        .group li:last-child {
            border-bottom: none;
        }

        .summary-box {
            border: 1px solid #cbd5e0;
            padding: 20px;
            margin-top: 30px;
            background-color: #edf2f7;
            border-radius: 8px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }
        .summary-box h2 {
            color: #2d3748;
            margin-top: 0;
            margin-bottom: 1rem;
        }
        .summary-box h3 {
            color: #4a5568;
            margin-top: 1.25rem;
            margin-bottom: 0.5rem;
        }
        .error {
            color: #e53e3e;
            font-weight: bold;
            background-color: #fee2e2;
            padding: 8px;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .config {
            background-color: #fffbeb;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 24px;
            border: 1px solid #fbd38d;
        }
        .config p {
            margin-bottom: 0.5rem;
        }
        .input-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        .input-group label {
            font-weight: 500;
            min-width: 120px;
        }
        .input-group input[type="number"] {
            padding: 8px 12px;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            width: 80px;
            text-align: center;
            font-size: 1rem;
        }
        .calculate-button, .load-button {
            background-color: #4299e1;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-right: 10px;
        }
        .calculate-button:hover, .load-button:hover {
            background-color: #3182ce;
            transform: translateY(-1px);
        }
        .calculate-button:active, .load-button:active {
            background-color: #2b6cb0;
            transform: translateY(0);
        }
        #loadingMessage {
            text-align: center;
            padding: 30px;
            font-size: 1.1rem;
            color: #4a5568;
        }
        textarea {
            width: 100%;
            min-height: 150px;
            border: 1px solid #cbd5e0;
            border-radius: 8px;
            padding: 10px;
            font-family: 'monospace';
            font-size: 0.9rem;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-3xl font-extrabold text-center mb-6">Klassenindeling Generator voor Scholen en Leerkrachten</h1>
        <p class="text-center text-gray-600 mb-8">Optimaliseer eenvoudig de **groepsindeling** van jouw klas. Deze slimme tool helpt leerkrachten om **evenwichtige klassen** te creÃ«ren, rekening houdend met de **voorkeuren van leerlingen** en **specifieke restricties van de juf**.</p>

        <div class="config rounded-lg shadow-sm">
            <h2 class="text-xl font-semibold mb-3">Configuratie voor een Optimale Klassenindeling</h2>
            <p><strong class="font-medium">Gewicht Juf-restricties:</strong> <span class="text-red-600">Hoog (negatieve impact van -100 per overtreding)</span></p>
            <p><strong class="font-medium">Gewicht Leerling Voorkeur 1:</strong> <span class="text-green-600">Medium (positieve impact van +10 per vervulling)</span></p>
            <p><strong class="font-medium">Gewicht Leerling Voorkeur 2:</strong> <span class="text-green-500">Laag (positieve impact van +5 per vervulling)</span></p>
            <p><strong class="font-medium">Gewicht Leerling Voorkeur 3:</strong> <span class="text-green-400">Zeer laag (positieve impact van +2 per vervulling)</span></p>

            <div class="input-group mt-4">
                <label for="groupSizeInput" class="text-gray-700">Gewenste **groepsgrootte** (leerlingen per groep):</label>
                <input type="number" id="groupSizeInput" value="4" min="2" max="20" class="focus:ring-blue-500 focus:border-blue-500">
            </div>
            <div class="input-group">
                <label for="numIterationsInput" class="text-gray-700">Aantal **startpogingen** voor algoritme (X):</label>
                <input type="number" id="numIterationsInput" value="100" min="10" max="10000" class="focus:ring-blue-500 focus:border-blue-500">
            </div>
            <div class="input-group">
                <label for="localSearchAttemptsInput" class="text-gray-700">**Lokale zoekpogingen** per start (fijnere afstemming):</label>
                <input type="number" id="localSearchAttemptsInput" value="500" min="10" max="5000" class="focus:ring-blue-500 focus:border-blue-500">
            </div>

            <h2 class="text-xl font-semibold mt-6 mb-3">Laad Jouw Eigen Klassen Dataset</h2>
            <p class="text-gray-600">Gebruik je eigen **leerlinggegevens**! Kopieer de data uit je Excel-template (vanaf de eerste leerlingrij, zonder de header) en plak deze hieronder. Zorg dat kolommen gescheiden zijn door tabs of komma's. De verwachte volgorde is: **Naam, Voorkeur 1, Voorkeur 2, Voorkeur 3, Juf Restricties**.</p>
            <textarea id="datasetInput" placeholder="Plak hier je dataset (bijv. gekopieerd uit Excel/Google Sheets)..."></textarea>
            <button id="loadDatasetButton" class="load-button w-full sm:w-auto mt-4">Laad Dataset</button>
            <button id="calculateButton" class="calculate-button w-full sm:w-auto mt-4">Bereken Indeling</button>
        </div>

        <div id="loadingMessage" class="hidden">
            <p class="text-lg font-medium text-gray-700">De **klassenindeling** wordt berekend... Een moment geduld.</p>
        </div>

        <div id="bestIndeling" class="hidden">
            <h2 class="text-2xl font-bold mb-4">Beste Gevonden Klassenindeling</h2>
            <div class="group-container" id="klassenGroepen">
                </div>

            <div class="summary-box rounded-lg shadow-md mt-8">
                <h2 class="text-xl font-bold mb-3">Gedetailleerde Samenvatting van de Indeling</h2>
                <h3 class="text-lg font-semibold mt-4 mb-2">Juf's Eisen (Restricties):</h3>
                <p id="jufSummary" class="text-gray-700"></p>
                <h3 class="text-lg font-semibold mt-4 mb-2">Leerlingen's Wensen (Voorkeuren):</h3>
                <p id="kinderSummary" class="text-gray-700"></p>
                <h3 class="text-lg font-semibold mt-4 mb-2">Algemene Statistieken van de Berekening:</h3>
                <p class="text-gray-700">Gemiddelde score over alle startpogingen: <span id="averageScore" class="font-bold text-blue-600"></span></p>
            </div>
            <p class="text-lg font-semibold mt-6">Totale Score van deze indeling: <span id="totalScore" class="text-blue-700 text-2xl"></span></p>
        </div>
    </div>

    <script>
        // Scoring weights
        const JUF_RESTRICTION_PENALTY = -100; // High negative score for teacher's restrictions (weight)
        const PREFERENCE_1_BONUS = 10;       // Bonus for first preferred buddy
        const PREFERENCE_2_BONUS = 5;        // Bonus for second preferred buddy
        const PREFERENCE_3_BONUS = 2;        // Bonus for third preferred buddy (new)

        // Default student data (used if no custom data is loaded)
        let leerlingen = [
            // Example data (no 'geslacht' column)
            { naam: 'David', voorkeur1: 'Ruben', voorkeur2: 'Lars', voorkeur3: 'Tom', jufNietSamenMet: ['Lisa', 'Max'] },
            { naam: 'Floris', voorkeur1: 'Thijs', voorkeur2: 'Joep', voorkeur3: 'Sem', jufNietSamenMet: [] },
            { naam: 'Gijs', voorkeur1: 'Casper', voorkeur2: 'Daan', voorkeur3: 'Bas', jufNietSamenMet: ['Evi'] },
            { naam: 'Joep', voorkeur1: 'Floris', voorkeur2: 'Siem', voorkeur3: 'Sam', jufNietSamenMet: ['Tom', 'Iris'] },
            { naam: 'Kees', voorkeur1: 'Mees', voorkeur2: 'David', voorkeur3: 'Lars', jufNietSamenMet: [] },
            { naam: 'Lars', voorkeur1: 'Ruben', voorkeur2: 'David', voorkeur3: 'Kees', jufNietSamenMet: [] },
            { naam: 'Max', voorkeur1: 'Siem', voorkeur2: 'Joep', voorkeur3: 'Floris', jufNietSamenMet: ['Bram', 'David'] },
            { naam: 'Mees', voorkeur1: 'Kees', voorkeur2: 'Gijs', voorkeur3: 'Daan', jufNietSamenMet: [] },
            { naam: 'Ruben', voorkeur1: 'David', voorkeur2: 'Lars', voorkeur3: 'Thijs', jufNietSamenMet: [] },
            { naam: 'Sam', voorkeur1: 'Thijs', voorkeur2: 'Floris', voorkeur3: 'Joep', jufNietSamenMet: [] },
            { naam: 'Sem', voorkeur1: 'Bram', voorkeur2: 'Floris', voorkeur3: 'Bas', jufNietSamenMet: ['Thijs'] },
            { naam: 'Siem', voorkeur1: 'Max', voorkeur2: 'Joep', voorkeur3: 'Sam', jufNietSamenMet: [] },
            { naam: 'Thijs', voorkeur1: 'Floris', voorkeur2: 'Sam', voorkeur3: 'Ruben', jufNietSamenMet: ['Sem'] },
            { naam: 'Tom', voorkeur1: 'Bram', voorkeur2: 'David', voorkeur3: 'Max', jufNietSamenMet: ['Joep', 'Lisa', 'Anna'] },
            { naam: 'Anna', voorkeur1: 'Lisa', voorkeur2: 'Sarah', voorkeur3: 'Evi', jufNietSamenMet: ['Tom', 'Noor'] },
            { naam: 'Eva', voorkeur1: 'Fleur', voorkeur2: 'Iris', voorkeur3: 'Kim', jufNietSamenMet: [] },
            { naam: 'Fleur', voorkeur1: 'Eva', voorkeur2: 'Lynn', voorkeur3: 'Sarah', jufNietSamenMet: [] },
            { naam: 'Iris', voorkeur1: 'Kim', voorkeur2: 'Eva', voorkeur3: 'Fleur', jufNietSamenMet: ['Joep', 'Noor'] },
            { naam: 'Kim', voorkeur1: 'Iris', voorkeur2: 'Lynn', voorkeur3: 'Eva', jufNietSamenMet: [] },
            { naam: 'Lisa', voorkeur1: 'Anna', voorkeur2: 'Sarah', voorkeur3: 'Kim', jufNietSamenMet: ['David', 'Tom'] },
            { naam: 'Lynn', voorkeur1: 'Fleur', voorkeur2: 'Kim', voorkeur3: 'Iris', jufNietSamenMet: [] },
            { naam: 'Noor', voorkeur1: 'Sarah', voorkeur2: 'Anna', voorkeur3: 'Lynn', jufNietSamenMet: ['Iris', 'Anna'] },
            { naam: 'Sarah', voorkeur1: 'Anna', voorkeur2: 'Lisa', voorkeur3: 'Noor', jufNietSamenMet: [] }
        ];

        // Store the default dataset to revert to if needed
        const defaultLeerlingen = deepCopyStudents(leerlingen);

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function generateClassroomDivision(students, groupSize) {
            const shuffledStudents = shuffleArray([...students]);
            const numGroups = Math.ceil(shuffledStudents.length / groupSize);
            const groups = Array.from({ length: numGroups }, () => []);

            let groupIndex = 0;
            for (const student of shuffledStudents) {
                groups[groupIndex].push(student);
                groupIndex = (groupIndex + 1) % numGroups;
            }

            for (let i = 0; i < groups.length; i++) {
                while (groups[i].length > groupSize) {
                    const studentToMove = groups[i].pop();
                    const nextGroupIndex = (i + 1) % groups.length;
                    groups[nextGroupIndex].push(studentToMove);
                }
            }
            return groups;
        }

        function scoreDivision(division) {
            let totalScore = 0;
            let jufConflicts = 0;
            let kidsPref1Count = 0;
            let kidsPref2Count = 0;
            let kidsPref3Count = 0;

            for (const group of division) {
                for (let i = 0; i < group.length; i++) {
                    const student1 = group[i];

                    for (let j = i + 1; j < group.length; j++) {
                        const student2 = group[j];
                        if (student1.jufNietSamenMet.includes(student2.naam) || student2.jufNietSamenMet.includes(student1.naam)) {
                            totalScore += JUF_RESTRICTION_PENALTY;
                            jufConflicts++;
                        }
                    }

                    const partner1InGroup = group.some(s => s.naam === student1.voorkeur1);
                    if (partner1InGroup && student1.voorkeur1) {
                        totalScore += PREFERENCE_1_BONUS;
                        kidsPref1Count++;
                    } else {
                        const partner2InGroup = group.some(s => s.naam === student1.voorkeur2);
                        if (partner2InGroup && student1.voorkeur2) {
                            totalScore += PREFERENCE_2_BONUS;
                            kidsPref2Count++;
                        } else {
                            const partner3InGroup = group.some(s => s.naam === student1.voorkeur3);
                            if (partner3InGroup && student1.voorkeur3) {
                                totalScore += PREFERENCE_3_BONUS;
                                kidsPref3Count++;
                            }
                        }
                    }
                }
            }
            return { totalScore, jufConflicts, kidsPref1Count, kidsPref2Count, kidsPref3Count };
        }

        function deepCopyDivision(division) {
            return division.map(group => group.map(student => ({ ...student })));
        }

        function deepCopyStudents(students) {
            return students.map(student => ({
                naam: student.naam,
                voorkeur1: student.voorkeur1,
                voorkeur2: student.voorkeur2,
                voorkeur3: student.voorkeur3,
                jufNietSamenMet: [...student.jufNietSamenMet]
            }));
        }

        function localSearch(initialDivision, maxAttempts, groupSize) {
            let currentDivision = deepCopyDivision(initialDivision);
            let currentScore = scoreDivision(currentDivision).totalScore;

            for (let attempt = 0; attempt < maxAttempts; attempt++) {
                let improved = false;

                const allStudents = currentDivision.flat();
                if (allStudents.length === 0) continue;

                const studentToMove = allStudents[Math.floor(Math.random() * allStudents.length)];
                
                let originalGroupIndex = -1;
                for(let i = 0; i < currentDivision.length; i++) {
                    if (currentDivision[i].some(s => s.naam === studentToMove.naam)) {
                        originalGroupIndex = i;
                        break;
                    }
                }

                let targetGroupIndex = Math.floor(Math.random() * currentDivision.length);
                if (currentDivision.length > 1) {
                    while (targetGroupIndex === originalGroupIndex) {
                        targetGroupIndex = Math.floor(Math.random() * currentDivision.length);
                    }
                } else {
                    continue;
                }

                const testDivision = deepCopyDivision(currentDivision);
                
                testDivision[originalGroupIndex] = testDivision[originalGroupIndex].filter(s => s.naam !== studentToMove.naam);
                
                if (testDivision[targetGroupIndex].length < groupSize) {
                    testDivision[targetGroupIndex].push(studentToMove);
                    const newScore = scoreDivision(testDivision).totalScore;

                    if (newScore > currentScore) {
                        currentDivision = testDivision;
                        currentScore = newScore;
                        improved = true;
                    }
                }

                if (!improved && allStudents.length >= 2 && currentDivision.length >= 2) {
                    const student1 = allStudents[Math.floor(Math.random() * allStudents.length)];
                    let student2 = allStudents[Math.floor(Math.random() * allStudents.length)];

                    let group1Index = -1, group2Index = -1;
                    for(let i = 0; i < currentDivision.length; i++) {
                        if (currentDivision[i].some(s => s.naam === student1.naam)) group1Index = i;
                        if (currentDivision[i].some(s => s.naam === student2.naam)) group2Index = i;
                    }

                    if (group1Index !== -1 && group2Index !== -1 && group1Index !== group2Index) {
                        const testSwapDivision = deepCopyDivision(currentDivision);

                        testSwapDivision[group1Index] = testSwapDivision[group1Index].filter(s => s.naam !== student1.naam);
                        testSwapDivision[group1Index].push(student2);

                        testSwapDivision[group2Index] = testSwapDivision[group2Index].filter(s => s.naam !== student2.naam);
                        testSwapDivision[group2Index].push(student1);

                        const newSwapScore = scoreDivision(testSwapDivision).totalScore;

                        if (newSwapScore > currentScore) {
                            currentDivision = testSwapDivision;
                            currentScore = newSwapScore;
                            improved = true;
                        }
                    }
                }
            }
            return currentDivision;
        }

        function parseDataset(text) {
            const parsedStudents = [];
            const lines = text.split('\n').filter(line => line.trim() !== '');

            for (const line of lines) {
                let parts = line.split('\t');
                if (parts.length < 5) {
                    parts = line.split(',');
                }

                if (parts.length >= 5) {
                    const naam = parts[0].trim();
                    const voorkeur1 = parts[1] ? parts[1].trim() : '';
                    const voorkeur2 = parts[2] ? parts[2].trim() : '';
                    const voorkeur3 = parts[3] ? parts[3].trim() : '';
                    const jufNietSamenMetRaw = parts[4] ? parts[4].trim() : '';

                    const jufNietSamenMet = jufNietSamenMetRaw
                        .split(',')
                        .map(name => name.trim())
                        .filter(name => name !== '');

                    if (naam && naam.toLowerCase() !== 'naam leerling' && !naam.endsWith(':')) {
                        parsedStudents.push({
                            naam: naam,
                            voorkeur1: voorkeur1,
                            voorkeur2: voorkeur2,
                            voorkeur3: voorkeur3,
                            jufNietSamenMet: jufNietSamenMet
                        });
                    }
                }
            }
            return parsedStudents;
        }

        function calculateDivision() {
            const loadingMessage = document.getElementById('loadingMessage');
            const bestIndelingDiv = document.getElementById('bestIndeling');
            const klassenGroepenDiv = document.getElementById('klassenGroepen');
            const jufSummaryP = document.getElementById('jufSummary');
            const kinderSummaryP = document.getElementById('kinderSummary');
            const totalScoreSpan = document.getElementById('totalScore');
            const averageScoreSpan = document.getElementById('averageScore');
            const groupSizeInput = document.getElementById('groupSizeInput');
            const numIterationsInput = document.getElementById('numIterationsInput');
            const localSearchAttemptsInput = document.getElementById('localSearchAttemptsInput');
            const datasetInput = document.getElementById('datasetInput');

            const selectedGroupSize = parseInt(groupSizeInput.value, 10);
            const numIterations = parseInt(numIterationsInput.value, 10);
            const localSearchAttempts = parseInt(localSearchAttemptsInput.value, 10);

            let currentLeerlingen = [];
            if (datasetInput.value.trim() !== '') {
                currentLeerlingen = parseDataset(datasetInput.value);
                if (currentLeerlingen.length === 0) {
                    klassenGroepenDiv.innerHTML = '<p class="error">Geen geldige leerlingdata gevonden in het tekstvak. Controleer het formaat en zorg dat er minimaal 5 kolommen zijn (Naam, Voorkeur 1, Voorkeur 2, Voorkeur 3, Juf Restricties).</p>';
                    bestIndelingDiv.classList.remove('hidden');
                    loadingMessage.classList.add('hidden');
                    return;
                }
            } else {
                currentLeerlingen = deepCopyStudents(defaultLeerlingen);
            }

            if (isNaN(selectedGroupSize) || selectedGroupSize < 2 || selectedGroupSize > currentLeerlingen.length) {
                klassenGroepenDiv.innerHTML = `<p class="error">Ongeldige groepsgrootte. Voer een getal in tussen 2 en ${currentLeerlingen.length} (gebaseerd op geladen data).</p>`;
                bestIndelingDiv.classList.remove('hidden');
                loadingMessage.classList.add('hidden');
                return;
            }
            if (isNaN(numIterations) || numIterations < 10 || numIterations > 10000) {
                klassenGroepenDiv.innerHTML = `<p class="error">Ongeldig aantal startpogingen. Voer een getal in tussen 10 en 10000.</p>`;
                bestIndelingDiv.classList.remove('hidden');
                loadingMessage.classList.add('hidden');
                return;
            }
            if (isNaN(localSearchAttempts) || localSearchAttempts < 10 || localSearchAttempts > 5000) {
                klassenGroepenDiv.innerHTML = `<p class="error">Ongeldig aantal lokale zoekpogingen. Voer een getal in tussen 10 en 5000.</p>`;
                bestIndelingDiv.classList.remove('hidden');
                loadingMessage.classList.add('hidden');
                return;
            }

            klassenGroepenDiv.innerHTML = '';
            bestIndelingDiv.classList.add('hidden');
            loadingMessage.classList.remove('hidden');

            let bestScore = -Infinity;
            let bestDivision = null;
            let bestSummary = {};
            let totalScoresSum = 0;

            for (let i = 0; i < numIterations; i++) {
                const initialDivision = generateClassroomDivision(currentLeerlingen, selectedGroupSize);
                const improvedDivision = localSearch(initialDivision, localSearchAttempts, selectedGroupSize);
                const currentScoreData = scoreDivision(improvedDivision);

                totalScoresSum += currentScoreData.totalScore;

                if (currentScoreData.totalScore > bestScore) {
                    bestScore = currentScoreData.totalScore;
                    bestDivision = improvedDivision;
                    bestSummary = currentScoreData;
                }
            }

            const averageScore = totalScoresSum / numIterations;

            loadingMessage.classList.add('hidden');
            bestIndelingDiv.classList.remove('hidden');

            if (bestDivision) {
                bestDivision.forEach((group, index) => {
                    const groupDiv = document.createElement('div');
                    groupDiv.classList.add('group', 'rounded-lg', 'shadow-sm');
                    groupDiv.innerHTML = `<h3 class="text-lg font-semibold mb-2">Groep ${index + 1}</h3>`;
                    if (group.length > selectedGroupSize) {
                        groupDiv.innerHTML += `<p class="error">Let op: Deze groep is te groot! (${group.length} i.p.v. ${selectedGroupSize})</p>`;
                    }
                    const ul = document.createElement('ul');
                    group.forEach(student => {
                        const li = document.createElement('li');
                        li.textContent = student.naam;
                        ul.appendChild(li);
                    });
                    groupDiv.appendChild(ul);
                    klassenGroepenDiv.appendChild(groupDiv);
                });

                jufSummaryP.textContent = `Aantal conflicten met juf's restricties: ${bestSummary.jufConflicts} (afgestraft met ${bestSummary.jufConflicts * JUF_RESTRICTION_PENALTY} punten).`;
                
                const totalStudents = currentLeerlingen.length;
                const totalPrefOpportunities = totalStudents;

                kinderSummaryP.textContent = `Aantal vervulde eerste voorkeuren: ${bestSummary.kidsPref1Count} van ${totalPrefOpportunities} (bonus: ${bestSummary.kidsPref1Count * PREFERENCE_1_BONUS} punten). Aantal vervulde tweede voorkeuren: ${bestSummary.kidsPref2Count} van ${totalPrefOpportunities} (bonus: ${bestSummary.kidsPref2Count * PREFERENCE_2_BONUS} punten). Aantal vervulde derde voorkeuren: ${bestSummary.kidsPref3Count} van ${totalPrefOpportunities} (bonus: ${bestSummary.kidsPref3Count * PREFERENCE_3_BONUS} punten).`;
                
                totalScoreSpan.textContent = bestScore;
                averageScoreSpan.textContent = averageScore.toFixed(2);

            } else {
                klassenGroepenDiv.innerHTML = '<p class="error">Geen indeling gevonden. Controleer de configuratie of verhoog het aantal iteraties.</p>';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const calculateButton = document.getElementById('calculateButton');
            const loadDatasetButton = document.getElementById('loadDatasetButton');
            
            calculateButton.addEventListener('click', calculateDivision);
            loadDatasetButton.addEventListener('click', calculateDivision);

            calculateDivision();
        });
    </script>
</body>
</html> 